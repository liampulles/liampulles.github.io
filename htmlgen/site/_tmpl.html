{{define "root"}}
    <!doctype html>
    <html lang=en color-mode=light>
    <meta charset=utf-8>

    <!-- Page metadata -->
    <title>{{.Title}}</title>
    <meta name=description content="{{.SEODescription}}">
    <meta name=author content="Liam Pulles">
    <meta name=viewport content="width=device-width,initial-scale=1">

    <!-- Dark mode toggle script -->
    <script>
    if (localStorage.getItem("color-mode") === "dark" || (window.matchMedia("(prefers-color-scheme: dark)").matches && !localStorage.getItem("color-mode"))) { 
        document.documentElement.setAttribute("color-mode", "dark"); 
    }</script>

    <!-- Fonts -->
    <link rel=preconnect href=https://cdnjs.cloudflare.com>
    <link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin=anonymous referrerpolicy=no-referrer>
    <link rel=preload href=https://fonts.gstatic.com/s/sourcesanspro/v22/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7l.woff2 as=font
        type=font/woff2 crossorigin>
    <link rel=preload
        href=https://fonts.gstatic.com/s/fraunces/v31/6NUh8FyLNQOQZAnv9bYEvDiIdE9Ea92uemAk_WBq8U_9v0c2Wa0K7iN7hzFUPJH58nib1603gg7S2nfgRYIctxuTCf7T.woff2
        as=font type=font/woff2 crossorigin>

    <!-- Stylesheets -->
    <link href=/style.css rel=stylesheet>
    <link href=/light.css rel=stylesheet>
    <link href=/dark.css rel=stylesheet>
    <link href=/images/favicon.ico rel="shortcut icon" type=image/x-icon>

    <!-- Header/Nav -->
    <header class=site-header>
        <p><a href= />Liam Pulles</a>
        <nav>
            <ul>
                {{range .NavElem}}
                <li><a href=/{{.Short}}.html>{{.Text}}</a>
                {{end}}
            </ul>
        </nav>
        <div class=color-mode__header>
            <!-- <svg class="svg-icon color-mode__btn light--hidden" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M13 3a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0V3ZM6.3 5A1 1 0 0 0 5 6.2l1.4 1.5a1 1 0 0 0 1.5-1.5L6.3 5Zm12.8 1.3A1 1 0 0 0 17.7 5l-1.5 1.4a1 1 0 0 0 1.5 1.5L19 6.3ZM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm-9 4a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2H3Zm16 0a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2h-2ZM7.8 17.7a1 1 0 1 0-1.5-1.5L5 17.7A1 1 0 1 0 6.3 19l1.5-1.4Zm9.9-1.5a1 1 0 0 0-1.5 1.5l1.5 1.4a1 1 0 0 0 1.4-1.4l-1.4-1.5ZM13 19a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0v-2Z" clip-rule="evenodd"/>
            </svg> -->
            <!-- Darth vader -->
            <svg class="svg-icon color-mode__btn dark--hidden" viewBox="0 0 20 20" fill="currentColor">
                <path fill="evenodd" d="M16.853,8.355V5.888c0-3.015-2.467-5.482-5.482-5.482H8.629c-3.015,0-5.482,2.467-5.482,5.482v2.467l-2.741,7.127c0,1.371,4.295,4.112,9.594,4.112s9.594-2.741,9.594-4.112L16.853,8.355z M5.888,17.367c-0.284,0-0.514-0.23-0.514-0.514c0-0.284,0.23-0.514,0.514-0.514c0.284,0,0.514,0.23,0.514,0.514C6.402,17.137,6.173,17.367,5.888,17.367z M5.203,10c0-0.377,0.19-0.928,0.423-1.225c0,0,0.651-0.831,1.976-0.831c0.672,0,1.141,0.309,1.141,0.309C9.057,8.46,9.315,8.938,9.315,9.315v1.028c0,0.188-0.308,0.343-0.685,0.343H5.888C5.511,10.685,5.203,10.377,5.203,10z M7.944,16.853H7.259v-1.371l0.685-0.685V16.853z M9.657,16.853H8.629v-2.741h1.028V16.853zM8.972,13.426v-1.028c0-0.568,0.46-1.028,1.028-1.028c0.568,0,1.028,0.46,1.028,1.028v1.028H8.972z M11.371,16.853h-1.028v-2.741h1.028V16.853z M12.741,16.853h-0.685v-2.056l0.685,0.685V16.853z M14.112,17.367c-0.284,0-0.514-0.23-0.514-0.514c0-0.284,0.23-0.514,0.514-0.514c0.284,0,0.514,0.23,0.514,0.514C14.626,17.137,14.396,17.367,14.112,17.367z M14.112,10.685h-2.741c-0.377,0-0.685-0.154-0.685-0.343V9.315c0-0.377,0.258-0.855,0.572-1.062c0,0,0.469-0.309,1.141-0.309c1.325,0,1.976,0.831,1.976,0.831c0.232,0.297,0.423,0.848,0.423,1.225S14.489,10.685,14.112,10.685z M18.347,15.801c-0.041,0.016-0.083,0.023-0.124,0.023c-0.137,0-0.267-0.083-0.319-0.218l-2.492-6.401c-0.659-1.647-1.474-2.289-2.905-2.289c-0.95,0-1.746,0.589-1.754,0.595c-0.422,0.317-1.084,0.316-1.507,0C9.239,7.505,8.435,6.916,7.492,6.916c-1.431,0-2.246,0.642-2.906,2.292l-2.491,6.398c-0.069,0.176-0.268,0.264-0.443,0.195c-0.176-0.068-0.264-0.267-0.195-0.444l2.492-6.401c0.765-1.911,1.824-2.726,3.543-2.726c1.176,0,2.125,0.702,2.165,0.731c0.179,0.135,0.506,0.135,0.685,0c0.04-0.029,0.99-0.731,2.165-0.731c1.719,0,2.779,0.814,3.542,2.723l2.493,6.404C18.611,15.534,18.524,15.733,18.347,15.801z"></path>
            </svg>
            <!-- Leah -->
            <svg class="svg-icon color-mode__btn light--hidden" viewBox="0 0 20 20" fill="currentColor">
                <circle fill="evenodd" cx="7.884" cy="11.397" r="0.699"></circle>
                <circle fill="evenodd" cx="12.076" cy="11.397" r="0.699"></circle>
                <path fill="evenodd" d="M17.685,5.808c-0.257,0-0.502,0.053-0.73,0.139C16.64,2.737,13.649,0.219,10,0.219c-3.649,0-6.64,2.518-6.955,5.728c-0.228-0.086-0.473-0.139-0.73-0.139c-1.153,0-2.096,0.943-2.096,2.096v3.493c0,1.153,0.943,2.096,2.096,2.096c0.28,0,0.547-0.058,0.792-0.158c0.113,1.088,0.304,1.795,0.585,2.254c0.539,0.834,4.139,4.192,6.288,4.192c2.149,0,5.751-3.361,6.272-4.167c0.292-0.476,0.488-1.196,0.602-2.296c0.255,0.112,0.536,0.175,0.831,0.175c1.153,0,2.096-0.943,2.096-2.096V7.904C19.781,6.751,18.838,5.808,17.685,5.808zM15.078,14.855c-0.482,0.746-3.715,3.529-5.099,3.529s-4.616-2.783-5.097-3.525c-0.319-0.521-0.444-1.919-0.489-3.297c0.004-0.055,0.017-0.108,0.017-0.164V8.603c0-0.04,0.005-0.078,0.006-0.118C4.779,8.56,5.156,8.603,5.545,8.603c1.994,0,3.706-1.037,4.455-2.519c0.749,1.482,2.461,2.519,4.455,2.519c0.389,0,0.766-0.043,1.128-0.118c0.001,0.039,0.006,0.078,0.006,0.118c0,0.077-0.008,0.152-0.012,0.229C15.598,10.276,15.641,13.938,15.078,14.855z"></path>
            </svg>
            <!-- <svg class="svg-icon color-mode__btn dark--hidden" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M11.7 2a10 10 0 1 0 9.8 13.3 1 1 0 0 0-1-1.3H20a8 8 0 0 1-7.6-10.6l.1-.4a1 1 0 0 0-.8-1Z" clip-rule="evenodd"/>
            </svg> -->
        </div>
    </header>

    <!-- Main content -->
    <main>
        {{template "article" .Article}}
    </main>

    <!-- Footer -->
    {{template "footer" .Footer}}

    <!-- Helper scripts -->
    <script src=/script.js></script>
    <script src="https://unpkg.com/htmx.org@1.9.10/dist/htmx.min.js"></script>
{{end}}

{{define "section"}}
<section>
    {{if .Header}}<h2 id="{{.Header}}"><a class="anchor" href="#{{.Header}}">{{.Header}}</a></h2>{{end}}
    {{if .SubHeader}}<h3 id="{{.SubHeader}}"><a class="anchor" href="#{{.SubHeader}}">{{.SubHeader}}</a></h3>{{end}}
    {{if .Aside.Figures}}
    <aside>
        {{range .Aside.Figures}}
        <figure {{if .Optional}}class="optional"{{end}}>
            {{range .Images}}
            {{template "image" .}}
            {{end}}
            {{if .Caption}}<figcaption><i>{{.Caption}}</i></figcaption>{{end}}
        </figure>
        {{end}}
    </aside>
    {{end}}
    {{.Content}}
</section>
{{end}}

{{define "image"}}
<img src="{{.Src}}" width="{{.Width}}" height="{{.Height}}" alt="{{.Alt}}">
{{end}}

{{define "article"}}
<article>
    <header>
        <h1>{{.Header}}</h1>
        {{.HeaderContent}}
    </header>
    {{.RawContent}}
    {{range .Sections}}
        {{template "section" .}}
    {{end}}
</article>
{{end}}

{{define "footer"}}
<footer>
    {{if .Comments}}
    <p><b>Comments? Send me an <a href="mailto:me@liampulles.com">email</a>. Or, share this piece:</b></p>
    <p>
        <a href="https://twitter.com/intent/tweet?url={{.Comments.FullURL}}"
            aria-label="Share on Twitter" target=_blank><i class="fa-brands fa-square-twitter fa-xl"></i></a>
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url={{.Comments.FullURL}}"
            aria-label="Share on LinkedIn" target=_blank><i class="fa-brands fa-linkedin fa-xl"></i></a>
        <a href="https://news.ycombinator.com/submitlink?u={{.Comments.FullURL}}"
            aria-label="Share on Hacker News" target=_blank><i class="fa-brands fa-square-hacker-news fa-xl"></i></a>
        <a href="http://reddit.com/submit?url={{.Comments.FullURL}}"
            aria-label="Share on Reddit" target=_blank><i class="fa-brands fa-square-reddit fa-xl"></i></a>
        <a href="https://www.facebook.com/sharer.php?u={{.Comments.FullURL}}"
            aria-label="Share on Facebook" target=_blank><i class="fa-brands fa-square-facebook fa-xl"></i></a>
        <a href="mailto:me@liampulles.com"><i class="fa-solid fa-square-envelope fa-xl"></i></a>
    </p>
    {{end}}
    {{if .ConnectWithMe}}
    <p>
        <b>Connect with me:</b>
        <a href=https://github.com/liampulles>Github</a>,
        <a href=https://www.linkedin.com/in/liampulles/>LinkedIn</a>,
        <a href=https://letterboxd.com/sl1m/>Letterboxd</a>,
        <a href="mailto:me@liampulles.com">Email</a>
    <p>
    {{end}}
    <p>Â© {{.Year}} Liam Pulles.</p>
</footer>
{{end}}

{{define "index-toc"}}
<section>
    <p>Hi there - if you're interested in my writing, read on. If you want to hire me (or otherwise find out more about me), then you may wish to see my <a href="/biography.html">biography</a>, or my <a href="/reviews.html">film reviews</a>, or my <a href="/code.html">code</a>.</p>
</section>
<section class="toc">
    <h3>Blog posts</h3>
    <table>
        {{range .BlogPosts}}
        <tr>
            <th class="toc-date">{{.Date.Format "02 Jan 2006"}}</th>
            <th><a href="/{{.Page.Short}}.html">{{.Page.Data.Title}}</a></th>
        </tr>
        {{end}}
    </table>
    <!-- Has snippet link -->
    <a class="snippet-link" hx-get="/snippet/digital-restorations.html"
        hx-swap="afterend"><h3>Digital restorations</h3></a>
    <table>
        {{range .DigitalRestorations}}
        <tr>
            <th class="toc-date">{{.Date.Format "02 Jan 2006"}}</th>
            <th><a href="/{{.Page.Short}}.html">{{.Page.Data.Title}}</a></th>
        </tr>
        {{end}}
    </table>
</section>
{{end}}

{{define "redirect"}}
<!doctype html>
<link rel=canonical href={{.Dest}}>
<meta charset=utf-8>
<meta http-equiv=refresh content="0;url={{.Dest}}">
<p>Redirecting...</p>
<a href={{.Dest}}>Click here if you are not redirected.</a>
{{end}}

{{define "restoration-page"}}
<section class="centerpiece">
    <a href="{{.Image.Src}}">{{template "image" .Image}}</a>
    {{.Description}}
</section>
{{end}}

{{define "snippet"}}
<section class="snippet">
    <p class="close-snippet" onclick="this.closest('.snippet').remove()">Close</p>
    {{if .Header}}<h2>{{.Header}}</h2>{{end}}
    {{.Content}}
</section>
{{end}}

{{define "reviews"}}
<section>
    <p style="text-align: center;"><a class="snippet-link" hx-get="/snippet/rating-system.html"
        hx-swap="afterend">Click here</a> to see my rating system.</p>
    <p>Below are the film reviews I've written on <a href="https://letterboxd.com/sl1m">Letterboxd</a>, separated by
        the years in which I watched and reviewed them. All opinions are my own.</p>
</section>
{{range .Years}}
<section>
    <h3>{{.Year}}</h3>
    {{range .Reviews}}
    <details>
        <summary>
            <span class="stars">{{.Stars}}</span>
            <span><i>{{.Name}} ({{.Year}})</i></span>
        </summary>
        <section>
            <aside>
                <figure>
                    <img loading="lazy" src="{{.PosterHref}}" width="230" height="345">
                </figure>
            </aside>
            <header>
                <h2>{{.Name}} ({{.Year}})</h2>
                <h3>{{.Stars}}</h3>
                <i>Reviewed {{.DateReviewed.Format "2 January 2006"}}</i>
            </header>
            {{.Review}}
            <p>
                <i><a href="{{.LetterboxdURI}}" target="_blank">See on Letterboxd</a></i>
            </p>
        </section>
    </details>
    {{end}}
</section>
{{end}}
{{end}}